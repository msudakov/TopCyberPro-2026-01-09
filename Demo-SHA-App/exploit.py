import hlextend

ORIGINAL_MESSAGE = b"user=attacker;action=view"
original_hash = "a57b1764e6ec86543269fc59b855304ea17ba99ac65c9f9e1d8baa5b8c6c8318"

known_message = ORIGINAL_MESSAGE
known_hash = original_hash
secret_length = 32
append_data = b";admin=true"

sha = hlextend.new("sha256")
forged_full_message = sha.extend(append_data, known_message, secret_length, known_hash)
forged_hash = sha.hexdigest()

print(f"Known original message: {known_message.decode()}")
print(f"Known original hash: {known_hash}")
print(f"Data to append: {append_data.decode()}")
print("-" * 40)
print(f"Forged full message (hex): {forged_full_message.hex()}")
print(f"Forged new hash: {forged_hash}")
